{% comment %}Partial: lista de notificaciones (usada por AJAX){% endcomment %}
<div id="notificaciones-list" class="space-y-3">
    {% for n in notificaciones %}
    <div id="notif-{{ n.id }}" class="bg-white rounded-lg shadow-sm border-l-4 transition-all hover:shadow-md 
        {% if not n.leida %}
            {% if n.tipo == 'critica' %}border-l-[#C0392B] bg-[#FFF5F5]
            {% elif n.tipo == 'alerta' %}border-l-[#F2A900] bg-[#FFFBF0]
            {% else %}border-l-[#1F6FB2] bg-[#F0F7FF]{% endif %}
        {% else %}
            border-l-gray-200 bg-white
        {% endif %}">
        
        <div class="p-6 notification-card" data-detail-url="{% url 'notificaciones:detalle_notificacion' n.id %}">
            <div class="flex gap-4">
                <div class="w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 
                    {% if n.tipo == 'critica' %}bg-[#FFEBEE] text-[#C0392B]
                    {% elif n.tipo == 'alerta' %}bg-[#FEF3E2] text-[#F2A900]
                    {% else %}bg-[#E3F2FD] text-[#1F6FB2]{% endif %}">
                    {% if n.tipo == 'critica' %}
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    {% elif n.tipo == 'alerta' %}
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                    {% else %}
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    {% endif %}
                </div>

                <div class="flex-1">
                    <div class="flex items-start justify-between mb-1">
                        <div class="flex items-center gap-2">
                            <h3 class="font-medium text-[#2C2C2C]">{{ n.titulo }}</h3>
                            {% if not n.leida %}
                                <span class="w-2 h-2 bg-[#1F6FB2] rounded-full"></span>
                            {% endif %}
                        </div>
                        <span class="text-xs text-[#6E6E6E]">{{ n.fecha }} • {{ n.hora }}</span>
                    </div>
                    <p class="text-sm text-[#6E6E6E] mb-3">{{ n.mensaje }}</p>
                    
                    <div class="flex items-center gap-2">
                        <span class="px-2.5 py-0.5 rounded-full text-xs font-medium
                            {% if n.tipo == 'critica' %}bg-[#FFEBEE] text-[#C0392B]
                            {% elif n.tipo == 'alerta' %}bg-[#FEF3E2] text-[#F2A900]
                            {% else %}bg-[#E3F2FD] text-[#1F6FB2]{% endif %}">
                            {{ n.tipo|title }}
                        </span>
                        
                        {% if n.siniestro_id %}
                            <span class="px-2.5 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs">{{ n.siniestro_id }}</span>
                        {% endif %}
                        <div class="ml-auto flex items-center gap-2">
                            <form action="{% url 'notificaciones:marcar_notificacion' n.id %}" method="POST" class="inline-block ajax-action" data-action="toggle" data-pk="{{ n.id }}">
                                {% csrf_token %}
                                <button type="button" title="Marcar leída/no leída" class="p-2 hover:bg-accent rounded btn-mark">
                                    <i data-lucide="mail" class="w-4 h-4 text-muted-foreground"></i>
                                </button>
                            </form>

                            <form action="{% url 'notificaciones:eliminar_notificacion' n.id %}" method="POST" class="inline-block ajax-action" data-action="delete" data-pk="{{ n.id }}">
                                {% csrf_token %}
                                <button type="button" title="Eliminar" class="p-2 hover:bg-accent rounded btn-delete">
                                    <i data-lucide="x" class="w-4 h-4 text-red-600"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="bg-white rounded-lg p-12 text-center border border-dashed border-gray-300">
        <p class="text-gray-500">No tienes notificaciones pendientes.</p>
    </div>
    {% endfor %}
</div>
